<!DOCTYPE html>
<html>
<head>
    <title>View Transactions</title>
</head>
<body>
    <h1>View Transactions</h1>

    <form method="get" action="{% url 'view_transactions' %}">
        <label for="search_notes">Search Notes:</label>
        <input type="text" id="search_notes" name="search_notes">
        <br>
        <label for="date_from">From:</label>
        <input type="date" id="date_from" name="date_from">
        <label for="date_to">To:</label>
        <input type="date" id="date_to" name="date_to">
        <br>
        <label for="amount_gt">Amount Greater Than:</label>
        <input type="number" id="amount_gt" name="amount_gt">
        <label for="amount_lt">Amount Less Than:</label>
        <input type="number" id="amount_lt" name="amount_lt">
        <label for="amount_eq">Amount Equal To:</label>
        <input type="number" id="amount_eq" name="amount_eq">
        <br>
        <label for="type">Type:</label>
        <select id="type" name="type">
            <option value="" selected disables hidden>-- Select Type --</option>
            <option value="expense">Expense</option>
            <option value="income">Income</option>
        </select>
        <label for="categories">Categories:</label>
        <select id="categories" name="categories">
            <option value="" selected disabled hidden>-- Select Category --</option>
            {% for category in categories %}
                <option value="{{ category.id }}">{{ category.name }}</option>
            {% endfor %}
        </select>
        <br>
        <button type="submit">Apply Filters</button>
    </form>

    <table border="1">
        <tr>
            <th>Date</th>
            <th>Amount</th>
            <th>Category</th>
            <th>Type</th>
            <th>Notes</th>
            <th>Actions</th>
        </tr>
        {% for transaction in transactions %}
        <tr>
            <td>{{ transaction.date }}</td>
            <td>{{ transaction.amount }}</td>
            <td>{{ transaction.category }}</td>
            <td>{{ transaction.type }}</td>
            <td>{{ transaction.notes }}</td>
            <td>
                <form method="post" action="{% url 'delete_transaction' transaction.id %}">
                    {% csrf_token %}
                    <button type="submit" onclick="return confirm('Are you sure you want to delete this transaction?')">Delete</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </table>

    <p>Total Income: {{ total_income }}</p>
    <p>Total Expenses: {{ total_expenses }}</p>

    <a href="{% url 'new_transaction' %}"><button>Add New Transaction</button></a>
</body>
</html>
